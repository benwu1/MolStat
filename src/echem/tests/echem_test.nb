(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24827,        664]
NotebookOptionsPosition[     22676,        584]
NotebookOutlinePosition[     23109,        601]
CellTagsIndexPosition[     23066,        598]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tests for the Simulator Models", "Section",
 CellChangeTimes->{{3.6085591912218513`*^9, 3.6085591933715973`*^9}, {
  3.6312841014978848`*^9, 3.6312841037057343`*^9}}],

Cell[CellGroupData[{

Cell["Nernstian Reactions", "Subsection",
 CellChangeTimes->{{3.608559657965395*^9, 3.608559662699814*^9}, 
   3.608571745026094*^9, {3.6322518339481783`*^9, 3.632251839324486*^9}}],

Cell["Test function", "Text",
 CellChangeTimes->{{3.63232816587529*^9, 3.632328167514461*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EredoxNernstian", "[", 
    RowBox[{"Eref_", ",", "Ab_", ",", "Af_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reducedEredox", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reducedEredox", "=", 
       RowBox[{"Eref", "-", 
        RowBox[{"Log", "[", 
         FractionBox["Ab", "Af"], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Redox Potential (Reduced Units): \>\"", "<>", 
        RowBox[{"ToString", "[", "reducedEredox", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.613820505607638*^9, 3.6138206130999823`*^9}, {
  3.61382064693325*^9, 3.6138206666827803`*^9}, {3.613835030713237*^9, 
  3.613835055558404*^9}, {3.6322517797690797`*^9, 3.632251781258165*^9}, {
  3.63231629674811*^9, 3.6323163216490717`*^9}, {3.632316360672305*^9, 
  3.632316379256463*^9}, {3.632316460239882*^9, 3.632316548069199*^9}, {
  3.63231864756157*^9, 3.632318678920002*^9}, {3.6323188937116537`*^9, 
  3.632318944629426*^9}}],

Cell["Tests", "Text",
 CellChangeTimes->{{3.632328169387252*^9, 3.6323281696664457`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "1.1"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "3"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "3"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNernstian", "[", 
    RowBox[{"Eref", ",", "Ab", ",", "Af"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
   3.6085597161193333`*^9, 3.6085597675553083`*^9}, 3.60856060722332*^9, {
   3.61926579958862*^9, 3.619265805498262*^9}, {3.619265862935032*^9, 
   3.619265869948452*^9}, {3.632252017269664*^9, 3.6322520951721196`*^9}, {
   3.6323191109979343`*^9, 3.6323191124144993`*^9}}],

Cell[BoxData["\<\"Redox Potential (Reduced Units): 1.1\"\>"], "Print",
 CellChangeTimes->{{3.6323165403093157`*^9, 3.632316551734282*^9}, 
   3.632318950654883*^9, 3.632318990483029*^9, 3.632319121887281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "1.1"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"8.0", " ", 
       SuperscriptBox["10", "5"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "3"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNernstian", "[", 
    RowBox[{"Eref", ",", "Ab", ",", "Af"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
  3.6085597161193333`*^9, 3.6085597675553083`*^9}, {3.60856060073641*^9, 
  3.608560648126318*^9}, {3.619265844015503*^9, 3.619265881276836*^9}, {
  3.632252109005911*^9, 3.6322521250128264`*^9}, {3.632319117664567*^9, 
  3.6323191190550623`*^9}}],

Cell[BoxData["\<\"Redox Potential (Reduced Units): 6.17517\"\>"], "Print",
 CellChangeTimes->{3.632316596591374*^9, 3.6323189522036867`*^9, 
  3.6323189923229027`*^9, 3.632319123180333*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "0.4"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"8.0", " ", 
       SuperscriptBox["10", "5"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"9.0", " ", 
       SuperscriptBox["10", "8"]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNernstian", "[", 
    RowBox[{"Eref", ",", "Ab", ",", "Af"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
  3.6085597161193333`*^9, 3.6085597675553083`*^9}, {3.60856060073641*^9, 
  3.608560648126318*^9}, {3.608561079437639*^9, 3.60856109013211*^9}, {
  3.6192658877907133`*^9, 3.619265900339574*^9}, {3.632252129996112*^9, 
  3.632252159660808*^9}, {3.632316747541465*^9, 3.632316748949106*^9}, {
  3.632319148901226*^9, 3.632319150535054*^9}}],

Cell[BoxData["\<\"Redox Potential (Reduced Units): -6.62554\"\>"], "Print",
 CellChangeTimes->{3.632316597574559*^9, 3.6323167499033337`*^9, 
  3.63231895606319*^9, 3.632318993807535*^9, 3.632319150875683*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Non-Nernstian Reactions", "Subsection",
 CellChangeTimes->{{3.608559657965395*^9, 3.608559662699814*^9}, {
   3.608561292043438*^9, 3.608561292915244*^9}, 3.608571746394112*^9, {
   3.619268095285861*^9, 3.6192680959710283`*^9}, {3.619276371789603*^9, 
   3.619276372747563*^9}, {3.6322518427236805`*^9, 3.6322518500120974`*^9}}],

Cell["Test function", "Text",
 CellChangeTimes->{{3.632328147867489*^9, 3.632328149282827*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EredoxNonNernstian", "[", 
    RowBox[{
    "Eref_", ",", "Af_", ",", "Ab_", ",", "lambda_", ",", "v_", ",", "e0_", 
     ",", "tlim_", ",", "accuracy_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "kf", ",", "kb", ",", "PO", ",", "Eapplied", ",", "solODE", ",", 
       "initialguess", ",", "tguessForward", ",", "tguessBackward", ",", 
       "solForwardETtime", ",", "solBackwardETtime", ",", "t", ",", 
       "ForwardETPotential", ",", "BackwardETPotential", ",", 
       "reducedForwardETPotential", ",", "reducedBackwardETPotential"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Eapplied", "[", "t_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"e0", "+", 
              RowBox[{"v", " ", "t"}]}], ",", 
             RowBox[{"t", "<", "tlim"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"e0", "+", 
              RowBox[{"2.0", "v", " ", "tlim"}], "-", 
              RowBox[{"v", " ", "t"}]}], ",", 
             RowBox[{"t", "\[GreaterEqual]", " ", "tlim"}]}], "}"}]}], "}"}], 
         ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kf", "[", "t_", "]"}], ":=", 
       RowBox[{"Af", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", 
           FractionBox["1.0", 
            RowBox[{"4.0", " ", "lambda", " "}]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Eapplied", "[", "t", "]"}], "-", "Eref", "+", 
             "lambda"}], ")"}], "2"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kb", "[", "t_", "]"}], ":=", 
       RowBox[{"Ab", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", 
           FractionBox["1.0", 
            RowBox[{"4.0", " ", "lambda", " "}]]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Eapplied", "[", "t", "]"}], "-", "Eref", "-", 
             "lambda"}], ")"}], "2"]}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"solODE", "=", 
       RowBox[{"NDSolveValue", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"PO", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kf", "[", "t", "]"}], "+", 
                 RowBox[{"kb", "[", "t", "]"}]}], ")"}]}], 
              RowBox[{"PO", "[", "t", "]"}]}], "+", 
             RowBox[{"kb", "[", "t", "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"PO", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
         "PO", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", 
           RowBox[{"2.0", "tlim"}]}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<StiffnessSwitching\>\""}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "accuracy"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"initialguess", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Eapplied", "[", "t", "]"}], "\[Equal]", "Eref"}], ",", 
         "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tguessForward", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", "t", "]"}], "/.", 
        RowBox[{
        "initialguess", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tguessBackward", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", "t", "]"}], "/.", 
        RowBox[{
        "initialguess", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"solForwardETtime", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"solODE", "[", "t", "]"}], "\[Equal]", "0.5"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tguessForward", ",", "0", ",", "tlim"}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"solBackwardETtime", "=", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"solODE", "[", "t", "]"}], "\[Equal]", "0.5"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tguessBackward", ",", "tlim", ",", 
           RowBox[{"2.0", "tlim"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ForwardETPotential", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Eapplied", "[", "t", "]"}], "]"}], "/.", 
        "solForwardETtime"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BackwardETPotential", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Eapplied", "[", "t", "]"}], "]"}], "/.", 
        "solBackwardETtime"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Forward potential (reduced units): \>\"", "<>", 
        RowBox[{"ToString", "[", "ForwardETPotential", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Backward potential (reduced units): \>\"", "<>", 
        RowBox[{"ToString", "[", "BackwardETPotential", "]"}]}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.60857192803577*^9, 3.608571929290156*^9}, {
   3.608571993687063*^9, 3.6085720525019417`*^9}, 3.6322518081527033`*^9, {
   3.6322594721246862`*^9, 3.6322594788801584`*^9}, {3.6322600731869197`*^9, 
   3.6322601222374315`*^9}, 3.632260183191939*^9, {3.6322664328104305`*^9, 
   3.632266435671449*^9}, {3.6322665190395336`*^9, 3.6322665259458847`*^9}, {
   3.63226658162759*^9, 3.632266583340686*^9}, {3.632266622717557*^9, 
   3.6322666259685764`*^9}, {3.6322667193687973`*^9, 3.632266744067758*^9}, {
   3.6322671470011044`*^9, 3.6322671481895447`*^9}, {3.632267180378824*^9, 
   3.632267192691311*^9}, 3.6322673474143057`*^9, {3.632267705725461*^9, 
   3.6322677204936113`*^9}, 3.632268136412646*^9, 3.632320378577786*^9, {
   3.632320416753051*^9, 3.632320460303254*^9}, {3.6323205305329437`*^9, 
   3.6323205528372183`*^9}, {3.632321473053937*^9, 3.632321553034522*^9}, {
   3.632322166316016*^9, 3.632322167329529*^9}, {3.6323222138812838`*^9, 
   3.632322219160472*^9}, {3.632322770122958*^9, 3.632322813887879*^9}}],

Cell["Tests", "Text",
 CellChangeTimes->{{3.6323281524423313`*^9, 3.632328152802726*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "1.1"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "3"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "3"]}]}], ",", 
     RowBox[{"lambda", "=", "0.625"}], ",", 
     RowBox[{"v", "=", "1.0"}], ",", 
     RowBox[{"e0", "=", "0."}], ",", 
     RowBox[{"tlim", "=", "2.5"}], ",", 
     RowBox[{"accuracy", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNonNernstian", "[", 
    RowBox[{
    "Eref", ",", "Af", ",", "Ab", ",", "lambda", ",", "v", ",", "e0", ",", 
     "tlim", ",", "accuracy"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.63226675917352*^9, 3.632266771728006*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Forward potential (reduced units): 1.10012\"\>"], "Print",
 CellChangeTimes->{3.632323135649263*^9}],

Cell[BoxData["\<\"Backward potential (reduced units): 1.09988\"\>"], "Print",
 CellChangeTimes->{3.632323135652124*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "1.2"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "6"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "6"]}]}], ",", 
     RowBox[{"lambda", "=", "0.725"}], ",", 
     RowBox[{"v", "=", 
      RowBox[{"1.0", " ", 
       SuperscriptBox["10", "3"]}]}], ",", 
     RowBox[{"e0", "=", "0."}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"2.5", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}], ",", 
     RowBox[{"accuracy", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNonNernstian", "[", 
    RowBox[{
    "Eref", ",", "Af", ",", "Ab", ",", "lambda", ",", "v", ",", "e0", ",", 
     "tlim", ",", "accuracy"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
   3.6085597161193333`*^9, 3.6085597675553083`*^9}, {3.60856060073641*^9, 
   3.608560648126318*^9}, {3.608561566186021*^9, 3.608561576049532*^9}, {
   3.619276404317801*^9, 3.6192764122760887`*^9}, {3.632258703778431*^9, 
   3.63225876015304*^9}, {3.632266789805393*^9, 3.632266803918293*^9}, {
   3.6322672116113167`*^9, 3.632267211720672*^9}, 3.6322672893584137`*^9, {
   3.6322673628145795`*^9, 3.6322674251925373`*^9}, {3.63226768362691*^9, 
   3.632267684095665*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Forward potential (reduced units): 1.2001\"\>"], "Print",
 CellChangeTimes->{3.632323447028122*^9}],

Cell[BoxData["\<\"Backward potential (reduced units): 1.19987\"\>"], "Print",
 CellChangeTimes->{3.632323447030375*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "0.9"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"lambda", "=", "0.525"}], ",", 
     RowBox[{"v", "=", 
      RowBox[{"1.0", " ", 
       SuperscriptBox["10", "6"]}]}], ",", 
     RowBox[{"e0", "=", "0."}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"2.5", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ",", 
     RowBox[{"accuracy", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNonNernstian", "[", 
    RowBox[{
    "Eref", ",", "Af", ",", "Ab", ",", "lambda", ",", "v", ",", "e0", ",", 
     "tlim", ",", "accuracy"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
  3.6085597161193333`*^9, 3.6085597675553083`*^9}, {3.60856060073641*^9, 
  3.608560648126318*^9}, {3.608561079437639*^9, 3.60856109013211*^9}, {
  3.608561621305478*^9, 3.608561633135004*^9}, {3.619276420274626*^9, 
  3.619276428656608*^9}, {3.63225878940018*^9, 3.6322587968931627`*^9}, {
  3.6322588355137105`*^9, 3.63225885710786*^9}, {3.6322681692457843`*^9, 
  3.632268187871235*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Forward potential (reduced units): 0.900104\"\>"], "Print",
 CellChangeTimes->{3.63232352509754*^9}],

Cell[BoxData["\<\"Backward potential (reduced units): 0.899887\"\>"], "Print",
 CellChangeTimes->{3.632323525100298*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "1.0"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "12"]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       SuperscriptBox["10", "12"]}]}], ",", 
     RowBox[{"lambda", "=", "0.825"}], ",", 
     RowBox[{"v", "=", 
      RowBox[{"1.0", " ", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"e0", "=", "0."}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"2.5", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}]}], ",", 
     RowBox[{"accuracy", "=", "15"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNonNernstian", "[", 
    RowBox[{
    "Eref", ",", "Af", ",", "Ab", ",", "lambda", ",", "v", ",", "e0", ",", 
     "tlim", ",", "accuracy"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
   3.6085597161193333`*^9, 3.6085597675553083`*^9}, 3.60856060722332*^9, {
   3.608561297164441*^9, 3.608561311075807*^9}, {3.608561496385501*^9, 
   3.6085614965427713`*^9}, {3.618680289457239*^9, 3.6186803070075197`*^9}, {
   3.619276436850596*^9, 3.619276441823942*^9}, {3.6322588924846334`*^9, 
   3.6322589010645094`*^9}, {3.632259055763816*^9, 3.6322590882276506`*^9}, {
   3.6322681905199137`*^9, 3.6322682004250593`*^9}, {3.632268366732292*^9, 
   3.6322683862095995`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Forward potential (reduced units): 1.00012\"\>"], "Print",
 CellChangeTimes->{3.6323235845700293`*^9}],

Cell[BoxData["\<\"Backward potential (reduced units): 0.999889\"\>"], "Print",
 CellChangeTimes->{3.632323584572342*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
The following test should not yield a forward or backward potential (which is \
what the output garbage means -- graceful failure tests are not included in \
the above script).\
\>", "Text",
 CellChangeTimes->{{3.632327907400051*^9, 3.6323279460771933`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Eref", "=", "1.0"}], ",", 
     RowBox[{"Af", "=", 
      RowBox[{"5.0", " ", 
       RowBox[{"10", "^", "6"}]}]}], ",", 
     RowBox[{"Ab", "=", 
      RowBox[{"5.0", " ", 
       RowBox[{"10", "^", "4"}]}]}], ",", 
     RowBox[{"lambda", "=", "0.825"}], ",", 
     RowBox[{"v", "=", "1.0"}], " ", ",", 
     RowBox[{"e0", "=", 
      RowBox[{"-", "1."}]}], ",", 
     RowBox[{"tlim", "=", "2.5"}], " ", ",", 
     RowBox[{"accuracy", "=", "15"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"EredoxNonNernstian", "[", 
    RowBox[{
    "Eref", ",", "Af", ",", "Ab", ",", "lambda", ",", "v", ",", "e0", ",", 
     "tlim", ",", "accuracy"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.608559675225573*^9, 3.6085596803105087`*^9}, {
   3.6085597161193333`*^9, 3.6085597675553083`*^9}, 3.60856060722332*^9, {
   3.608561297164441*^9, 3.608561311075807*^9}, {3.608561496385501*^9, 
   3.6085614965427713`*^9}, {3.618680289457239*^9, 3.6186803070075197`*^9}, {
   3.619276436850596*^9, 3.619276441823942*^9}, {3.6322588924846334`*^9, 
   3.6322589010645094`*^9}, {3.632259055763816*^9, 3.6322590882276506`*^9}, {
   3.6322681905199137`*^9, 3.6322682004250593`*^9}, {3.632268366732292*^9, 
   3.6322683862095995`*^9}, {3.632327806659235*^9, 3.632327895312304*^9}, {
   3.632329531769809*^9, 3.632329542373972*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "reged"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The point \[NoBreak]\\!\\({2.5`}\\)\[NoBreak] is at the \
edge of the search region \[NoBreak]\\!\\({0.`, 2.5`}\\)\[NoBreak] in \
coordinate \[NoBreak]\\!\\(1\\)\[NoBreak] and the computed search direction \
points outside the region. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/reged\\\", ButtonNote -> \
\\\"FindRoot::reged\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.632329542855176*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(MachinePrecision\\)\[NoBreak] digits of working precision to \
meet these tolerances. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.632329542867179*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Forward potential (reduced units): 1.5\"\>"], "Print",
 CellChangeTimes->{{3.632327818718441*^9, 3.6323278962486*^9}, 
   3.6323282036641207`*^9, 3.63232954286967*^9}],

Cell[BoxData["\<\"Backward potential (reduced units): 1.49816\"\>"], "Print",
 CellChangeTimes->{{3.632327818718441*^9, 3.6323278962486*^9}, 
   3.6323282036641207`*^9, 3.632329542871807*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell["Tests for the Fitter Models", "Section",
 CellChangeTimes->{{3.631284108433666*^9, 3.631284112826126*^9}}]
},
WindowSize->{685, 679},
WindowMargins->{{Automatic, 9}, {Automatic, 8}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 172, 2, 64, "Section"],
Cell[CellGroupData[{
Cell[777, 28, 181, 2, 44, "Subsection"],
Cell[961, 32, 94, 1, 30, "Text"],
Cell[1058, 35, 1166, 25, 173, "Input"],
Cell[2227, 62, 89, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[2341, 67, 792, 18, 56, "Input"],
Cell[3136, 87, 208, 2, 21, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3381, 94, 765, 18, 56, "Input"],
Cell[4149, 114, 189, 2, 21, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4375, 121, 857, 19, 56, "Input"],
Cell[5235, 142, 209, 2, 21, "Print"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[5493, 150, 335, 4, 36, "Subsection"],
Cell[5831, 156, 95, 1, 30, "Text"],
Cell[5929, 159, 6833, 158, 604, "Input"],
Cell[12765, 319, 89, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[12879, 324, 799, 21, 77, "Input"],
Cell[CellGroupData[{
Cell[13703, 349, 118, 1, 22, "Print"],
Cell[13824, 352, 119, 1, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13992, 359, 1415, 33, 78, "Input"],
Cell[CellGroupData[{
Cell[15432, 396, 117, 1, 22, "Print"],
Cell[15552, 399, 119, 1, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15720, 406, 1332, 32, 78, "Input"],
Cell[CellGroupData[{
Cell[17077, 442, 118, 1, 22, "Print"],
Cell[17198, 445, 120, 1, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17367, 452, 1425, 33, 78, "Input"],
Cell[CellGroupData[{
Cell[18817, 489, 120, 1, 22, "Print"],
Cell[18940, 492, 120, 1, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[19087, 497, 268, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[19380, 506, 1411, 30, 63, "Input"],
Cell[20794, 538, 620, 12, 60, "Message"],
Cell[21417, 552, 688, 13, 75, "Message"],
Cell[CellGroupData[{
Cell[22130, 569, 185, 2, 22, "Print"],
Cell[22318, 573, 191, 2, 22, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[22560, 581, 112, 1, 50, "Section"]
}
]
*)

(* End of internal cache information *)
